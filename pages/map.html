<!DOCTYPE html>
<html lang="en">

<head>
  <!-- ## for client-side less
  <link rel="stylesheet/less" type="text/css" href="/pelican-skeleton/theme/css/style.less">
  <script src="http://cdnjs.cloudflare.com/ajax/libs/less.js/1.7.3/less.min.js" type="text/javascript"></script>
  -->
  <link rel="stylesheet" type="text/css" href="/pelican-skeleton/theme/css/style.css">
  <link rel="stylesheet" type="text/css" href="/pelican-skeleton/theme/css/pygments.css">
  <link rel="stylesheet" type="text/css" href="http://fonts.googleapis.com/css?family=PT+Sans|PT+Serif|PT+Mono">
  <link href='http://fonts.googleapis.com/css?family=Roboto:900,400' rel='stylesheet' type='text/css'>
  <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css">

  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="author" content="Barry Wainstock">
  <meta name="description" content="Posts and writings by Barry Wainstock">

  <link href="/pelican-skeleton/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Barry Hikes The PCT Atom" />

  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta property="og:image" content="route.png" />
  <link rel="stylesheet" href="http://cdn.leafletjs.com/leaflet-0.7.3/leaflet.css" />
  <style>
    html, body, #map { margin: 0; height: 500px; background: #fff; }
    .leaflet-marker-live {
      -webkit-animation: pulse 2s ease-out;
      animation: pulse 2s ease-out;
      -webkit-animation-iteration-count: infinite;
      animation-iteration-count: infinite;
    }
    @-webkit-keyframes pulse {
      from { stroke-width: 15; stroke-opacity: 1; }
      to { stroke-width: 50; stroke-opacity: 0; }
    }
    @keyframes pulse {
      from { stroke-width: 15; stroke-opacity: 1; }
      to { stroke-width: 50; stroke-opacity: 0; }
    }
  </style>

  <title>
    Barry Hikes The PCT
&ndash; Map  </title>

<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-56109557-2']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>
</head>

<body>
  <aside>
    <div id="user_meta">
      <a href="/pelican-skeleton">
        <img id="logo" src="/pelican-skeleton//images/logo.jpg" alt="logo">
      </a>
      <h3><a href="/pelican-skeleton">Barry Wainstock</a></h3>
      <p>This is a journey from Mexico to Canada on my feet.</p>
      <div class="social-icons">
        <a href="https://twitter.com/barrywainstock" target="_blank"><i class="fa fa-twitter fa-lg"></i></a>
        <a href="https://instagram.com/bwainstock" target="_blank"><i class="fa fa-instagram fa-lg"></i></a>
        <a href="https://www.facebook.com/barrywainstock" target="_blank"><i class="fa fa-facebook fa-lg"></i></a>
        <a href="https://github.com/bwainstock/" target="_blank"><i class="fa fa-github fa-lg"></i></a>
      </div>
      <ul>
        <li><a href="/pelican-skeleton/pages/map.html">Map</a></li>
        <li><a href="/pelican-skeleton/pages/gear.html">Gear</a></li>
      </ul>
    </div>
  </aside>

  <main>
    <!-- <header>
      <p>
      <a href="/pelican-skeleton">Index</a> &brvbar; <a href="/pelican-skeleton/archives.html">Archives</a>
      &brvbar; <a href="/pelican-skeleton/feeds/all.atom.xml">Atom</a>
      </p>
    </header> -->

<article>
  <div class="article_title">
    <h3><a href="/pelican-skeleton/pages/map.html">Map</a></h3>
  </div>
  <div class="article_text">
    <div id="map"></div>
  </div>
  <div class="article_meta">
    <p>Updated on: Tue February 03, 2015</p>
  </div>
</article>

  <script src="http://cdn.leafletjs.com/leaflet-0.7.3/leaflet.js"></script>
  <script src="/pelican-skeleton/theme/js/reqwest.min.js"></script>
  <script src="/pelican-skeleton/theme/js/Leaflet.MakiMarkers.js"></script>
  <script src="/pelican-skeleton/theme/js/Leaflet.SpotTracker.js"></script>
  <script>
  var feed = decodeURI((RegExp('feed=' + '(.+?)(&|$)').exec(location.search)||[,null])[1]);
  var map = L.map('map').setView([45.5, -122.4], 7);
    
  L.tileLayer('http://{s}.tile.thunderforest.com/outdoors/{z}/{x}/{y}.png', {
  }).addTo(map);
  L.spotTracker(feed, {
    api: 'http://bwainstock.cartodb.com/api/v2/sql',
    url: "{api}?q=SELECT * FROM test ORDER BY unixtime",
    liveUrl: "{api}?q=SELECT * FROM pct_spot WHERE unixtime > {timestamp} ORDER BY unixtime",
    OK: {
      icon: L.MakiMarkers.icon({ icon: 'building',  color: '#145291', size: 'm' }),
      title: 'Hytte'
    },
    CUSTOM: {
      icon: L.MakiMarkers.icon({ icon: 'campsite', color: '#145291', size: 'm' }),
      title: 'Telt'
    },
    onClick: function (evt) {
      var message = evt.message;
      evt.layer.bindPopup(getTime(message.unixtime)).openPopup();
    },
    show: {
      'UNLIMITED-TRACK': 10,
      'OK': 10,
      'CUSTOM': 10
    }
  }).addTo(map);
  function getPlace (message) {
    if (message.placename) {
      return L.Util.template('<p><strong>{placename}</strong><br>{terrain} {altitude} moh.</p>', message);
    }
    return '';
  }
  function getTime (timestamp) {
    var t = new Date(timestamp * 1000);
    return L.Util.template('<p>{month} {date}, {year} {hours}:{minutes}</p>', {
      date: t.getDate(),
      month: ['January','February','March','April','May','June','July','August','September','October','November','December'][t.getMonth()],
      year: t.getFullYear(),
      hours: t.getHours(),
      minutes: ('0' + t.getMinutes()).slice(-2)
    });
  }
  function getWeather (message) {
    if (message.weather_symbol) {
      console.log(message.weather_symbol);
      return L.Util.template('<p><img src="http://api.yr.no/weatherapi/weathericon/1.1/?symbol={weather_symbol};content_type=image/png" width="38" height="38" style="float:left;margin:-5px 5px 10px -5px;">{temperature}°C - {precipitation} mm<br>{wind},<br>{wind_speed} m/s fra {direction}</p><p>Værdata fra <a href="http://api.yr.no">api.yr.no</a></p>', L.extend(message, {
          direction: { 
            'N':  'nord', 
            'NE': 'nordøst', 
            'E':  'øst', 
            'SE': 'sørøst',
            'S':  'sør', 
            'SW': 'sørvest',
            'W':  'vest',
            'NW': 'nordvest' 
          }[message.wind_direction]
        }));
    }
    return '';
  }
  </script>



    <div id="ending_message">
      <p>&copy; Barry Wainstock. Built using <a href="http://getpelican.com" target="_blank">Pelican</a>. Theme by Giulio Fidente on <a href="https://github.com/gfidente/pelican-svbhack" target="_blank">github</a>. .</p>
    </div>
  </main>
</body>
</html>